{% extends "exercise_base.html" %}

{% block title %}{{ block.super }}Command Injection{% endblock %}

{% block header %}
    <h1>Command Injection</h1>
{% endblock %}

{% block content %}
    <p>This page demonstrates a command injection vulnerability. The server
    uses a shell command to ping a hostname provided by the user. Because the
    input is not sanitized and <code>shell=True</code> is used, an attacker can
    inject arbitrary commands.</p>

    <p>Try entering a hostname like <code>localhost; cat /etc/passwd</code> or
    <code>localhost && whoami</code> to execute additional commands.</p>

    <fieldset>
        <form method="POST">
            <label for="hostname">Hostname to ping</label>
            <input name="hostname" value="{{ hostname }}" placeholder="e.g., localhost">
            <input type="submit" value="Ping">
        </form>
    </fieldset>

    {% if output %}
        <div class="panel">
            <h4>Command Output:</h4>
            <pre>{{ output }}</pre>
        </div>
    {% endif %}

    <div class="hints panel">
        <p>Hints for exploitation:</p>
        <ul>
            <li>Shell metacharacters like <code>;</code>, <code>&&</code>, <code>||</code>, and <code>|</code> can chain commands</li>
            <li>Try: <code>localhost; ls -la</code></li>
            <li>Try: <code>127.0.0.1 && id</code></li>
            <li>Backticks can also work: <code>`whoami`</code></li>
        </ul>
    </div>
{% endblock %}

{% block extra_topnav %}
<li><a href="{% url 'injection-code-execution' %}">Prev</a></li>
<li><a href="{% url 'injection-deserialization' %}">Next</a></li>
{% endblock %}

{% block extra_botnav %}
<li><a href="{% url 'injection-code-execution' %}">Prev</a></li>
<li><a href="{% url 'injection-deserialization' %}">Next</a></li>
{% endblock %}

